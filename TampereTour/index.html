<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tampere Tour 2026!</title>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>

  <style>
    :root { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    body { margin: 0; background: #0b0c10; color: #e9eef5; }
    header { padding: 14px 16px; border-bottom: 1px solid #1f2430; }
    header h1 { margin: 0; font-size: 18px; }
    header p { margin: 6px 0 0; opacity: 0.85; font-size: 14px; }

    .wrap { display: grid; grid-template-columns: 340px 1fr; min-height: calc(100vh - 66px); }
    #sidebar { padding: 12px; border-right: 1px solid #1f2430; background: #0f1117; overflow: auto; }
    #map { height: calc(100vh - 66px); }

    .stop {
      padding: 10px;
      border: 1px solid #1f2430;
      border-radius: 12px;
      margin-bottom: 10px;
      background: #0b0c10;
      cursor: pointer;
    }
    .stop:hover { border-color: #ef4444; }
    .stop h3 { margin: 0 0 4px; font-size: 15px; }
    .stop small { opacity: 0.8; display: block; line-height: 1.3; }

    .meta { margin-top: 6px; }
    .meta small { display: block; opacity: 0.85; }

    .note {
      font-size: 13px;
      opacity: 0.85;
      margin-top: 10px;
      line-height: 1.35;
    }

    @media (max-width: 900px) {
      .wrap { grid-template-columns: 1fr; }
      #map { height: 60vh; }
      #sidebar { border-right: none; border-top: 1px solid #1f2430; }
    }
  </style>
</head>

<body>
<header>
  <h1>Tampere Tour 2026!</h1>
  <p>Red markers are bars. Orange markers are tram stops. üè† is home.</p>
  <p>Tap each place below to zoom in on the map. Swipe down for the map.</p>
</header>

<div class="wrap">
  <div id="sidebar">
    <div id="stopList"></div>
    <div class="note">
      After Bonker Moodcourt we will be in the center and can go wherever, plenty of choice!
    </div>
  </div>
  <div id="map"></div>
</div>

<script>
  // Bars / pubs
  const stops = [
    { name: "Pub Kultainen Apina", lat: 61.45180039267094, lng: 23.847843030883727 },
    { name: "R-kioski Hervanta", lat: 61.45095110734877, lng: 23.84821247387784, note: "Stop here for Tram Beers." },
    { name: "Groove bar & bbq", lat: 61.46619566220167, lng: 23.83736737682503, note: "Check if open as times are weird." },
    { name: "Pub Lapin Akka", lat: 61.496300035697764, lng: 23.80814057065695 },
    { name: "Public House Huurre", lat: 61.495987278953805, lng: 23.80480193436901, note: "Get some food here?" },
    { name: "Salhojankadun Pub", lat: 61.499354755020235, lng: 23.784149045167645 },
    { name: "Pub Pikilinna", lat: 61.501091225467, lng: 23.781425030071357 },
    { name: "Bar Oma", lat: 61.501541579967686, lng: 23.781409583705603 },
    { name: "Wanha Mestari", lat: 61.50090578671909, lng: 23.779951155980573 },
    { name: "Bar Passion", lat: 61.49849771453917, lng: 23.77782132060677 },
    { name: "Bonker Moodcourt", lat: 61.49810116516109, lng: 23.77485009855998 }
  ];

  // Tram stops
  const tramStops = [
    { id: "HERVANTAKESKUS_A", name: "Hervantakeskus A", lat: 61.450418483919975, lng: 23.84988994888475 },
    { id: "HALLILA_A", name: "Hallila A", lat: 61.467118986998706, lng: 23.839698398653223 },
    { id: "UINTIKESKUS_A", name: "Uintikeskus A", lat: 61.49632008469776, lng: 23.804909177188826 },
    { id: "SAMMONAUKIO_A", name: "Sammonaukio A", lat: 61.49908956582903, lng: 23.785988958079777 }
  ];

  // Home
  const home = {
    name: "KOTI",
    lat: 61.47237800783689,
    lng: 23.728887560457608
  };

  // Tram legs by index
  const tramLegs = {
    1: { board: "HERVANTAKESKUS_A", exit: "HALLILA_A" },
    2: { board: "HALLILA_A", exit: "UINTIKESKUS_A" },
    4: { board: "UINTIKESKUS_A", exit: "SAMMONAUKIO_A" }
  };

  const map = L.map("map");
  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
    maxZoom: 19,
    attribution: "&copy; OpenStreetMap"
  }).addTo(map);

  // Icons
  const barIcon = L.divIcon({
    className: "",
    html: `<div style="width:14px;height:14px;border-radius:50%;background:#ef4444;border:2px solid #111827;"></div>`,
    iconSize: [14,14],
    iconAnchor: [7,7]
  });

  const tramIcon = L.divIcon({
    className: "",
    html: `<div style="width:14px;height:14px;border-radius:50%;background:#f59e0b;border:2px solid #111827;"></div>`,
    iconSize: [14,14],
    iconAnchor: [7,7]
  });

  const homeIcon = L.divIcon({
    className: "",
    html: `<div style="
      width:18px;height:18px;border-radius:4px;
      background:#22c55e;color:#022c22;
      display:flex;align-items:center;justify-content:center;
      font-size:12px;font-weight:700;
      border:2px solid #052e16;">üè†</div>`,
    iconSize: [18,18],
    iconAnchor: [9,9]
  });

  const bounds = [];
  const stopList = document.getElementById("stopList");

  function getTram(id) {
    return tramStops.find(t => t.id === id);
  }

  // Add bars
  stops.forEach((s, i) => {
    const ll = [s.lat, s.lng];
    bounds.push(ll);

    const marker = L.marker(ll, { icon: barIcon }).addTo(map);
    marker.bindPopup(`<b>${i + 1}. ${s.name}</b>${s.note ? `<br/>${s.note}` : ""}`);

    let tramInfo = "";
    if (tramLegs[i]) {
      const leg = tramLegs[i];
      const board = getTram(leg.board);
      const exit = getTram(leg.exit);
      if (board && exit) {
        tramInfo = `
          <div class="meta">
            <small><b>Next:</b> Tram</small>
            <small>Board: ${board.name}</small>
            <small>Exit: ${exit.name}</small>
          </div>`;
      }
    }

    const div = document.createElement("div");
    div.className = "stop";
    div.innerHTML = `
      <h3>${i + 1}. ${s.name}</h3>
      ${s.note ? `<small>${s.note}</small>` : ""}
      ${tramInfo}
    `;
    div.onclick = () => {
      map.setView(ll, 16);
      marker.openPopup();
    };
    stopList.appendChild(div);
  });

  // Add tram stops
  tramStops.forEach(t => {
    bounds.push([t.lat, t.lng]);
    L.marker([t.lat, t.lng], { icon: tramIcon })
      .addTo(map)
      .bindPopup(`<b>Tram stop</b><br/>${t.name}`);
  });

  // Add home
  bounds.push([home.lat, home.lng]);
  const homeMarker = L.marker([home.lat, home.lng], { icon: homeIcon }).addTo(map);
  homeMarker.bindPopup(`<b>${home.name}</b>`);

  const homeDiv = document.createElement("div");
  homeDiv.className = "stop";
  homeDiv.innerHTML = `<h3>üè† ${home.name}</h3><small>Home</small>`;
  homeDiv.onclick = () => {
    map.setView([home.lat, home.lng], 16);
    homeMarker.openPopup();
  };
  stopList.appendChild(homeDiv);

  map.fitBounds(bounds, { padding: [40, 40] });
</script>
</body>
</html>
